# Модуль sheet_services

Описание модуля

# Функции

| Signature                                                                                                                                                                                                                                                                                                                   | Decorator               | Docstring                                                                                                                                                               |
| :-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | :---------------------- | :---------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| rename_sheet( sheet: apps.dcis.models.document.Sheet, name: str) -> tuple[apps.dcis.models.document.Sheet, list[apps.dcis.models.sheet.Cell]]                                                                                                                                                                               | ['@transaction.atomic'] | Переименование листа с учетом формул.sheet.name -> name:param sheet - лист:param name - новое имя листа                                                                 |
| change_column_dimension( column_dimension: apps.dcis.models.sheet.ColumnDimension, width: int | None, fixed: bool, hidden: bool, kind: str) -> apps.dcis.models.sheet.ColumnDimension                                                                                                                                       | -                       | Изменение колонки.                                                                                                                                                      |
| add_row_dimension( user: apps.core.models.User, sheet: apps.dcis.models.document.Sheet, document_id: str | int, parent_id: int | None, index: int, global_index: int, global_indices_map: dict[int, int]) -> dict                                                                                                           | ['@transaction.atomic'] | Добавление строки.После добавления строки, строка приобретает новый индекс,соответственно, все строки после вставленной строки должны увеличить свой индекс на единицу. |
| change_row_dimension( row_dimension: apps.dcis.models.sheet.RowDimension, height: int, fixed: bool, hidden: bool, dynamic: bool) -> apps.dcis.models.sheet.RowDimension                                                                                                                                                     | -                       | Изменение строки.                                                                                                                                                       |
| delete_row_dimension(row_dimension: apps.dcis.models.sheet.RowDimension) -> int                                                                                                                                                                                                                                             | ['@transaction.atomic'] | Удаление строки.После удаления строки, все строки после удаленной строки должны уменьшить свой индекс на единицу.                                                       |
| change_cells_option( cells: Sequence[apps.dcis.models.sheet.Cell], field: str, value: str | int | bool | None) -> list[dict]                                                                                                                                                                                                | ['@transaction.atomic'] | Изменение свойств ячеек.                                                                                                                                                |
| update_or_create_value( document_id: int | str, sheet_id: int | str, column_id: int | str, row_id: int | str, value: str, payload: Any = None) -> apps.dcis.services.sheet_services.UpdateOrCrateValueResult                                                                                                                | -                       | Создание или обновление значения.                                                                                                                                       |
| update_or_create_file_value( user: apps.core.models.User, document_id: int | str, sheet_id: int | str, column_id: int | str, row_id: int | str, value: str, remaining_files: list[int], new_files: list[django.core.files.uploadedfile.InMemoryUploadedFile]) -> apps.dcis.services.sheet_services.UpdateOrCrateValueResult | -                       | Изменение файлов значения ячейки типа `Файл`.                                                                                                                           |
| create_file_value_archive(value: apps.dcis.models.sheet.Value, name: str) -> str                                                                                                                                                                                                                                            | -                       | Создание архива значения ячейки типа `Файл`.                                                                                                                            |
| get_file_value_files(value: apps.dcis.models.sheet.Value) -> list[devind_core.models.File]                                                                                                                                                                                                                                  | -                       | Получение файлов значения ячейки типа `Файл`.                                                                                                                           |
| get_file_value_payload(value: apps.dcis.models.sheet.Value) -> list[int]                                                                                                                                                                                                                                                    | -                       | Получение дополнительных данных значения ячейки типа `Файл`.                                                                                                            |
| move_merged_cells( sheet: apps.dcis.models.document.Sheet, idx: int, offset: int, delete: bool = False) -> None                                                                                                                                                                                                             | -                       | Двигаем объединенные строки в зависимости от добавления или удаления.В будущем метод нужно сделать универсальным (и для колонок).                                       |

# Класс CheckCellOptions

Описание класса Проверка возможности изменения свойств ячеек.

## Методы

| Signature                                                                                                                                                      | Decorator | Docstring                                                              |
| :------------------------------------------------------------------------------------------------------------------------------------------------------------- | :-------- | :--------------------------------------------------------------------- |
| __init__()                                                                                                                                                     | -         |                                                                        |
| __new__( cls, field: str, value: str) -> apps.dcis.services.sheet_services.CheckCellOptions.Success | apps.dcis.services.sheet_services.CheckCellOptions.Error | -         | Create and return a new object. See help(type) for accurate signature. |

# Класс UpdateOrCrateValueResult

Описание класса Результат создания или обновления значения.

## Методы

| Signature                                                                                          | Decorator | Docstring                                                                   |
| :------------------------------------------------------------------------------------------------- | :-------- | :-------------------------------------------------------------------------- |
| __init__( _cls, value: apps.dcis.models.sheet.Value, updated_at: datetime.datetime, created: bool) | -         | Create new instance of UpdateOrCrateValueResult(value, updated_at, created) |
| __new__( _cls, value: apps.dcis.models.sheet.Value, updated_at: datetime.datetime, created: bool)  | -         | Create new instance of UpdateOrCrateValueResult(value, updated_at, created) |
| __repr__(self)                                                                                     | -         | Return a nicely formatted representation string                             |
| __getnewargs__(self)                                                                               | -         | Return self as a plain tuple. Used by copy and pickle.                      |