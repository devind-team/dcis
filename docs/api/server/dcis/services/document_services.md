# Модуль document_services

Модуль, отвечающий за работу с документами.

### Функции

| Сигнатура                                                                                                                                                                                                                                    | Декораторы | Описание                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |
| :------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | :--------- | :----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| get_user_documents( user: apps.core.models.User, period: apps.dcis.models.project.Period &#124; int &#124; str) -&#62; django.db.models.query.QuerySet                                                                                       | -          | Получение документов пользователя для периода.Пользователь видит период документ: - пользователь обладает глобальной привилегией dcis.view_document - пользователь создал проект документа - пользователь создал период документа - период создан с множественным типом сбора, и пользователь добавлен в закрепленный за документом дивизион - период создан с единичным типом сбора, и пользователь добавлен в закрепленный за одной из строк документа дивизион - пользователь обладает локальной привилегией view_document, позволяющей просматривать все документы конкретного периода |
| create_new_document( user: apps.core.models.User, period: apps.dcis.models.project.Period, status_id: int, comment: str, document_id: int &#124; None = None, division_id: int &#124; None = None) -&#62; apps.dcis.models.document.Document | -          | Добавление нового документа.user - пользователь, который создает документperiod_id - собираемый периодstatus_id - идентификатор статуса устанавливаемого документаobject_id - идентификатор дивизиона                                                                                                                                                                                                                                                                                                                                                                                      |
| transfer_rows( user: apps.core.models.User, sheet: apps.dcis.models.document.Sheet, last_document: apps.dcis.models.document.Document, document: apps.dcis.models.document.Document, parent_id: int, parent_ids=None) -&#62; dict[int, int]  | -          | Переносим дочерние строки.Рекурсивно проходимся по строкам и создаем новые с трансфером идентификаторов для значений. row_id = 1 parent = none ----&#62; row_id = 1, parent = none - не участвует в трансфере row_id = 2 parent = 1 ----&#62; row_id = 5, parent = 1 transform[2] = 5 row_id = 3 parent = 1 ----&#62; row_id = 6, parent = 1 transform[3] = 6 row_id = 4 parent - 3 ----&#62; row_id = 7, parent = transform[parent_id = 3] = 6                                                                                                                                            |
| transfer_limitations( cell_original: int, cell: int, parent_id_original: int &#124; None = None, parent_id: int &#124; None = None) -&#62; None                                                                                              | -          | Рекурсивно переносим ограничения ячеек.cell_original - оригинальная ячейкаcell - ячейка в которую переносим ограниченияparent_id_original - идентификатор оригинального переносимого ограниченияparent_id - идентификатор переносимого ограничения                                                                                                                                                                                                                                                                                                                                         |